import nltk
import datetime

startTime = datetime.datetime.now()
diagNerFileBigram = 'Training/output/13000/NER_Files/bigram/diagnosis_bigram.ner'
diagNerFileBigramMatch = 'testing/output/set3/bigrams/diagnosis_bigram.ner'
diagNerFileBigramToRead = open (diagNerFileBigram,'r')
diagNerFileBigramToWrite = open (diagNerFileBigramMatch,'w')
inputString = "some issue of heart failure and heart attack is detected."
inputStringBigram = list(nltk.bigrams(inputString.split()))
bigramDetect = 0
print "Bigram Detector Started ....."
for i  in range(0, len(inputStringBigram)):
    #print "for 1>>>"
    print "Bigram From Input String ...."
    print inputStringBigram[i]
    #print i
    diagNerFileBigramToRead = open (diagNerFileBigram,'r')
    for line in diagNerFileBigramToRead:
        diagNerBigram = list (nltk.bigrams(line.split()))        #print "for 2 >>>"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
        if len(diagNerBigram) == 1:
            for j in range(0,len(diagNerBigram)):
                #print "for 3 >>>"
                #print "Bigram From File ...."
                #print diagNerBigram[j]
                #print str(j)+"outer j"
                if inputStringBigram[i] == diagNerBigram[j]:
                    #print j
                    #print "Bigram From File ...."
                    #print diagNerBigram[j]
                    print "match found>>"
                    print inputStringBigram[i]
                    diagNerFileBigramToWrite.write (inputStringBigram[i][0]+' '+inputStringBigram[i][1]+'\n')
                    bigramDetect = bigramDetect+1
diagNerFileBigramToRead.close()
diagNerFileBigramToWrite.close()
endTime = datetime.datetime.now()
timeDiff =endTime-startTime
formattedTime = divmod (timeDiff.days*86400+timeDiff.seconds,60)
print "Bigram Detector Ends ...."
print "Total Bigrams Detected:"+str(bigramDetect)
print "Total Time taken is " + str(formattedTime[0])+" munutes and "+str(formattedTime[1])+" seconds"


